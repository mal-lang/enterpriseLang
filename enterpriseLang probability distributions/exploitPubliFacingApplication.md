# Exploit Public-Facing Application

## Context
The use of software, data, or commands to take advantage of a weakness in an Internet-facing computer system or program in order to cause unintended or unanticipated behavior. The weakness in the system can be a bug, a glitch, or a design vulnerability. These applications are often websites, but can include databases (like SQL), standard services (like SMB or SSH), and any other applications with Internet accessible open sockets, such as web servers and related services. Depending on the flaw being exploited this may include Exploitation for Defense Evasion.

If an application is hosted on cloud-based infrastructure, then exploiting it may lead to compromise of the underlying instance. This can allow an adversary a path to access the cloud APIs or to take advantage of weak identity and access management policies.

For websites and databases, the OWASP top 10 and CWE top 25 highlight the most common web-based vulnerabilities.

## Findings
Taking into consideration the high severity vulnerabilities from the Acunetix Report (https://cdn2.hubspot.net/hubfs/4595665/Acunetix_web_application_vulnerability_report_2019.pdf) on web vulnerabilities, (This level indicates that an attacker can
fully compromise the confidentiality,
integrity or availability of a target system
without specialized access, user interaction
or circumstances that are beyond the
attackerâ€™s control. It is very likely to allow
lateral movement and escalation of the
attack to other systems on the internal
network of the vulnerable application.
) we can have an idea of how likely the adversary is to exploiting a Public-Facing Application : 46% of websites have high security vulnerabilities and 87% have medium vulnerabilities. We can assume that it will be faster to exploit a high vulnerability than a medium (because you wouldn't have to combine others to get there)

https://www.ptsecurity.com/ww-en/analytics/web-vulnerabilities-2020/#:~:text=The%20average%20number%20of%20vulnerabilities,five%20vulnerabilities%20has%20high%20severity.
-> Findings can be compared

### Other findings (not so relevant)
19% percent of sampled targets were found to be
vulnerable to SSH-related vulnerabilities.

But over 35% of websites and
web applications are susceptible to at least one single
high severity vulnerability.


## Results
|% of apps concerned|Severity| avg nb of vulnerabilities (is that relevant?)| Assumed Time to Find | Assumed TTC | Distribution |
|---|---|---|---|---|---|
|46-50% | High   | ~4.1 vuln/app | 1 hour   | ~0.5 day |Exponential(24)+Bernoulli(0.5)*Exponential(2)  |
|84-87% | Medium | ~12.3 vuln/app| 12 hours | ~2 days  |Exponential(2)+Bernoulli(0.87)*Exponential(0.5) |
|89%    | Low    | ~5.7 vuln/app | 24 hours | ~7 days  |Exponential(1)+Bernoulli(0.89)*Exponential(0.143) |

We assume that High severity vulnerabilities are the most known, fastest and most likely to be exploited vulnerabilities. Medium take more time to think about and exploit (+ combination of several exploits). Low vulnerabilities are much slower and less likely to be compromised. We also assume that the more vulnerabilities there are, the faster it is to find one.

Now to combine those 3 : We assume that the adversary will start by looking for high security vulnerabilities and try to exploit them, if they fail they then move on to the medium vulnerabilities and so on.

If there is a high security vulnerability they will find it and then exploit it, if there isn't, they will still have looked for it but won't exploit it. The probability distribution should follow this "if then else" scheme:

``` 
TTFHigh +
if ProbHigh
then TTCHigh
else TTFMedium +
    if ProbMedium
    then TTCMedium
    else TTFLow +
        if ProbLow
        then TTCLow
        else Infinity
``` 

The closest we can get to this is : 
``` 
[Exponential(24) 
+ Bernoulli(0.5)*Exponential(2)
+ Bernoulli(0.5)*(Exponential(2) 
                  + Bernoulli(0.87)*Exponential(0.5)
                  + Bernoulli(0.13)*(Exponential(1)
                                     + Bernoulli(0.89)*Exponential(0.143)
                                     + Bernoulli(0.11)*Infinity))
]
```

This distribution is a bit complicated and not 100% accurate since the Bernoulli distributions don't complement each other (as they would in a proper if then else statement). We thus decided to split thi into 3 parts (for High, Medium and Low vulnerabilities)