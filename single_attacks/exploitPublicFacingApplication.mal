category Person {
    asset Administrator {
        # privilegedAccountManagement
            info: "https://attack.mitre.org/mitigations/M1026/"
            ->  internalNetwork.exploitPublicFacingApplication,
                externalNetwork.exploitPublicFacingApplication // try (internalNetwork /\ externalNetwork).exploitPublicFacingApplication with higher version of MAL compiler
    } 
}

category Software {
    asset Service {
        | applicationVulnerability
            info: "The use of software, data, or commands to take advantage of a weakness in an Internet-facing computer system or program in order to cause unintended or unanticipated behavior."
            ->  internalNetwork.exploitPublicFacingApplication,
                externalNetwork.exploitPublicFacingApplication

        | exploitationForDefenseEvasion

        # applicationIsolationAndSandboxing
            info: "https://attack.mitre.org/mitigations/M1048/"
            ->  internalNetwork.exploitPublicFacingApplication,
                externalNetwork.exploitPublicFacingApplication

        # updateSoftware
            info: "https://attack.mitre.org/mitigations/M1051/"
            ->  internalNetwork.exploitPublicFacingApplication,
                externalNetwork.exploitPublicFacingApplication       
    } 

    abstractAsset OS {
        | systemAccess

        # exploitProtection
            info: "https://attack.mitre.org/mitigations/M1050/"
            ->  internalNetwork.exploitPublicFacingApplication,
                externalNetwork.exploitPublicFacingApplication
    } 
}

category Network {
    asset InternalNetwork {
        & exploitPublicFacingApplication
            info: "When exploiting Public-Facing Application, depending on the flaw being exploited it may include Exploitation for Defense Evasion."
            ->  service.exploitationForDefenseEvasion, // leads to exploitation for defense evasion attack
                os.systemAccess


        # networkSegmentation // Segment networks and systems appropriately to reduce access to critical systems and services to controlled methods.
            info: "https://attack.mitre.org/mitigations/M1030/"
            ->  exploitPublicFacingApplication

        # vulnerabilityScanning // Regularly scan the internal network for available services to identify new and potentially vulnerable services.
            info: "https://attack.mitre.org/mitigations/M1016/"
            ->  exploitPublicFacingApplication
    } 

    asset ExternalNetwork {
        & exploitPublicFacingApplication
            info: "When exploiting Public-Facing Application, depending on the flaw being exploited it may include Exploitation for Defense Evasion."
            ->  service.exploitationForDefenseEvasion, // leads to exploitation for defense evasion attack
                os.systemAccess

        # networkSegmentation // Segment networks and systems appropriately to reduce access to critical systems and services to controlled methods.
            info: "https://attack.mitre.org/mitigations/M1030/"
            ->  exploitPublicFacingApplication
    } 

}

associations {    
    InternalNetwork [internalNetwork] 1-* <--Use--> 1 [administrator] Administrator
    ExternalNetwork [externalNetwork] 1-* <--Use--> 1 [administrator] Administrator
    InternalNetwork [internalNetwork] 1 <--Contain--> 1-* [service] Service
    ExternalNetwork [externalNetwork] 1 <--Contain--> 1-* [service] Service  
    InternalNetwork [internalNetwork] 1-* <--Connect--> 1-* [os] OS
    ExternalNetwork [externalNetwork] 1-* <--Connect--> 1-* [os] OS
}











